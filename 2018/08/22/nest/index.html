<!DOCTYPE html>
<html lang="zh">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge">
    <meta name="msvalidate.01" content="4F51AD3A9C5F4DDDFA709DC1A6B5943D" />
    <meta name="baidu-site-verification" content="dKCP62k3HP" />
    <meta name="google-site-verification" content="hKWZlwbzCj0T7GJsIcIuQ6NKTAzBsz7wS8ppAm3f_zg" />
    <meta name="theme-color" content="#00695c">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="ç»´ç‰¹é™ˆå…ˆæ£®çš„åšå®¢ï¼Œæƒ…æ€€ä¸å‰ç«¯å¹¶è¿›ï¼Œç¾å­¦ä¸æŠ€æœ¯å¹¶è¡Œã€‚è®°å½•å…³äºå‰ç«¯çš„å­¦ä¹ ä¸ç”Ÿæ´»">
    <meta name="author" content="é™ˆä»•è±ª, victor_csh@outlook.com"/>
    <meta name="keywords"  content="å‰ç«¯,é™ˆä»•è±ª,ç»´ç‰¹é™ˆå…ˆæ£®,åšå®¢,Victor,shihao,chenshihao">
    <meta name="robots" content="index, follow">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
          Nest çœŸé¦™ - ç»´ç‰¹é™ˆå…ˆæ£®çš„åšå®¢ | Victor&#39;s Blog
        
    </title>

    <link rel="canonical" href="http://chenshihao.site/2018/08/22/nest/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">ç»´ç‰¹é™ˆå…ˆæ£®</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">é¦–é¡µ</a>
                    </li>

                    
                    
                    
                    
                    <li>
                        <a href="/archives/">å½’æ¡£</a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="/tags/">æ ‡ç­¾</a>
                    </li>
                    
                    

                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e) {
        if ($navbar.className.indexOf('in') > 0) {
            // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function () {
                // prevent frequently toggle
                if ($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            }, 400)
        } else {
            // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('support.jpg')
    }
    /*
     * ä¸´æ—¶ä¿®å¤é«˜åº¦é—®é¢˜
     */
    .intro-header + article{
        overflow-y: hidden;
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                          <a class="tag" href="/tags/#Nest" title="Nest">Nest</a>
                        
                          <a class="tag" href="/tags/#TypeScript" title="TypeScript">TypeScript</a>
                        
                          <a class="tag" href="/tags/#Node.js" title="Node.js">Node.js</a>
                        
                          <a class="tag" href="/tags/#Framework" title="Framework">Framework</a>
                        
                    </div>
                    <h1>Nest çœŸé¦™</h1>
                    <h2 class="subheading">æ¥ä¸€å£è€å¼Ÿ</h2>
                    <span class="meta">
                        é™ˆä»•è±ª å‘è¡¨äº 2018-08-22
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container">
                <blockquote>
<p>ä»Šå¤©çš„ä¸»é¢˜ä¸æ˜¯é›€å·¢å’–å•¡ï¼Œä¹Ÿä¸æ˜¯é›€å·¢å¥¶ç²‰ï¼Œæ¯•ç«Ÿæˆ‘ç‹å¢ƒæ³½å°±æ˜¯é¥¿æ­»ï¼Œä¹Ÿä¸ä¼šæ‰“ä½ ä»¬ä¸€ç‚¹å¹¿å‘Šã€‚</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2824648-58deb01a32726641.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Nest.js"></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿‘å‡ å¹´ç”±äº Node.js çš„å‘å±•ï¼ŒJavaScript å˜æˆäº†ä¸€ç§å…¨æ ˆé€šç”¨è¯­è¨€ï¼ŒåŒæ—¶è¯ç”Ÿäº†è¯¸å¦‚ Angularã€Reactã€Vue ç­‰ä¸€ç³»åˆ—æé«˜å¼€å‘è€…ç”Ÿäº§åŠ›çš„ä¼˜ç§€å‰ç«¯é¡¹ç›®æ¡†æ¶ï¼Œè¿™äº›æ¡†æ¶è®©æˆ‘ä»¬å¼€å‘æ›´å¿«é€Ÿã€æµ‹è¯•æ›´ä¾¿æ·ã€æ‹“å±•æ›´ç®€å•ã€‚</p>
<p>å°½ç®¡ Node.js æœåŠ¡ç«¯å¼€å‘é¢†åŸŸæœ‰ç€è¯¸å¦‚ Expressï¼ŒKoaï¼ŒFastify ç­‰ä¸€ç³»åˆ—ä¼˜ç§€çš„å¼€æºåº“ã€å·¥å…·ï¼Œä½†å´ç¼ºä¹çœŸæ­£æ„ä¹‰ä¸Šçš„æ¡†æ¶ã€‚</p>
<p>äºæ˜¯æˆ‘ä¸€ç›´åœ¨å¯»æ‰¾ï¼Œæ²¹è…»çš„å¸ˆå§ï¼Œåœ¨å“ªé‡Œâ€¦â€¦</p>
<p>ç›´åˆ°é‚£ä¸ªå†¬å­£ï¼Œæˆ‘é‡è§äº†å¥¹ â€”â€” Nestã€‚</p>
<h2 id="Nest-æ˜¯ä»€ä¹ˆ"><a href="#Nest-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Nest æ˜¯ä»€ä¹ˆ"></a>Nest æ˜¯ä»€ä¹ˆ</h2><p>å®˜æ–¹æ¦‚è¿°æ˜¯è¿™æ ·è¯´çš„ã€‚</p>
<blockquote>
<p>A progressive Node.js framework for building efficient, reliable and scalable server-side applications, heavily inspired by Angular. </p>
<p>ä¸€ä¸ªæ·±å— Angular å¯å‘ï¼Œæ—¨åœ¨æ„å»ºé«˜æ•ˆã€å¯é ã€é«˜æ‹“å±•æ€§æœåŠ¡ç«¯åº”ç”¨ç¨‹åºçš„å…ˆè¿›çš„ Node.js æ¡†æ¶ã€‚</p>
</blockquote>
<p>æ­£å¦‚ Nest ä½œè€…æ‰€è¨€â€”â€”æ·±å— Angular å¯å‘ï¼Œæ‰€ä»¥ Nest çš„å¼€å‘ä½“éªŒä¸ Angular æœ‰äº›ç±»ä¼¼ã€‚æ—¢å¯ä»¥ä½¿ç”¨ TypeScriptï¼ˆä¸ Angular ç›¸åŒï¼Œå®˜æ–¹æ¨èï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ JavaScript æ„å»ºé¡¹ç›®ï¼ŒåŒæ—¶ç»“åˆäº†é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject Oriented Programmingï¼‰ã€å‡½æ•°å¼ç¼–ç¨‹ï¼ˆFunctional Programmingï¼‰ã€å‡½æ•°å“åº”å¼ç¼–ç¨‹ï¼ˆFunctional Reactive Programmingï¼‰ç­‰å…ƒç´ ï¼Œå¯å…¼å®¹ä¸»æµç¬¬ä¸‰æ–¹åº“ä¸æ’ä»¶ã€‚ </p>
<p>ç›®å‰ Nest çš„ Github star æ•°åœ¨ 8000 å·¦å³ï¼Œæ¯”æˆ‘å…³æ³¨é‚£ä¼šé«˜äº†ä¸å°‘ã€‚</p>
<h2 id="Nest-ç‰¹ç‚¹"><a href="#Nest-ç‰¹ç‚¹" class="headerlink" title="Nest ç‰¹ç‚¹"></a>Nest ç‰¹ç‚¹</h2><p>ä»ä¸‹å›¾å¯ä»¥çœ‹åˆ°å®˜æ–¹å®è§‚æ¦‚è¿°çš„ç‰¹ç‚¹</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2824648-ff8fab7cff3d51ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<ol>
<li><p>é«˜æ‹“å±•æ€§ã€‚å¯æ­£å¸¸ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹åº“ã€‚</p>
</li>
<li><p>å¤šåŠŸèƒ½æ€§ã€‚é€‚ç”¨äºå¤šç§ç±»å‹çš„æœåŠ¡ç«¯åº”ç”¨ç¨‹åºç¼–å†™ã€‚</p>
</li>
<li><p>å‰æ²¿å…ˆè¿›ã€‚ç»“åˆæœ€å‰æ²¿çš„ JavaScript æŠ€æœ¯ç‰¹æ€§ï¼Œå°†è®¾è®¡æ¨¡å¼å’Œæˆç†Ÿæ–¹æ¡ˆçš„ç†å¿µå¸¦å…¥ Node.js é¢†åŸŸä¸­ã€‚ </p>
</li>
</ol>
<p>ä»¥ä¸Šæ˜¯è¾ƒä¸ºå®è§‚çš„ç‰¹æ€§æ¦‚è¿°ï¼Œå…³äºå…¶æŠ€æœ¯ä¸Šçš„ç‰¹ç‚¹ï¼Œæˆ‘è®¤ä¸ºè¾ƒä¸ºçªå‡ºçš„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li><p>å®˜æ–¹æ¨èä½¿ç”¨ TypeScriptï¼Œå·¥ç¨‹åŒ–æ„ä¹‰é‡å¤§ã€‚</p>
</li>
<li><p>åŸºäº Express ä¸ socket.io å¥—ä»¶ï¼Œå…¼å®¹å…¶ä»–åº“ã€‚</p>
</li>
<li><p>è¯­æ³•é£æ ¼ç±»ä¼¼ Angular 2+ï¼Œä¹Ÿç±»ä¼¼ Java Spring æ¡†æ¶ï¼Œå¤§é‡ä½¿ç”¨è£…é¥°å™¨ï¼ˆES7 Decoratorï¼‰å‡½æ•°ï¼Œæ— ä¾µå…¥å¼çš„è¯­æ³•ä½¿å¾—ä»£ç é€»è¾‘æ›´ä¸ºæ¸…æ™°ã€‚</p>
</li>
<li><p>éµå¾ªæ§åˆ¶åè½¬ï¼ˆIoC, Inversion of Controlï¼‰æ€æƒ³ï¼Œå¤§é‡ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼ˆDI, Dependency Injectionï¼‰çš„è®¾è®¡æ¨¡å¼ï¼Œå¤§å¤§é™ä½äº†å•å…ƒé—´çš„è€¦åˆåº¦ã€‚</p>
</li>
<li><p>å†…ç½®çš„å¼‚å¸¸æ§åˆ¶å±‚ï¼ˆException Filterï¼‰ï¼Œå¤§è‡³åº”ç”¨ï¼Œå°è‡³é€»è¾‘ï¼Œå¯¹å„ä¸ªçº§åˆ«çš„å¼‚å¸¸ä½œæ•è·ä¸å¤„ç†ï¼Œåœ¨ç¨‹åºå“åº”ä¸Šå¯¹ç”¨æˆ·æ›´ä¸ºå‹å¥½ã€‚</p>
</li>
<li><p>å†…ç½®çš„æƒé™æ§åˆ¶å±‚ï¼ˆGuardï¼‰ä¸æ‹¦æˆªå±‚ï¼ˆInterceptorï¼‰ã€‚</p>
</li>
<li><p>é›†æˆå·¥ç¨‹åŒ–çš„æµ‹è¯•ï¼Œå®˜æ–¹ä½¿ç”¨ Jest æµ‹è¯•æ¡†æ¶ã€‚</p>
</li>
</ol>
<h2 id="å°è¯•ç‰›åˆ€"><a href="#å°è¯•ç‰›åˆ€" class="headerlink" title="å°è¯•ç‰›åˆ€"></a>å°è¯•ç‰›åˆ€</h2><p>æˆ‘åˆšå¼€å§‹æ¥è§¦ Nest æ—¶ï¼Œæ–°å»ºé¡¹ç›®è¿˜æ²¡æœ‰ç°åœ¨è¿™ä¹ˆæ–¹ä¾¿ï¼Œç›¸å…³ä¾èµ–çš„å®‰è£…éƒ½æ¯”è¾ƒäººè‚‰ã€‚</p>
<p>ä¸è¿‡å¥½åœ¨å‰ä¸ä¹…æ­£å¼ç‰ˆ @nestjs/cli è„šæ‰‹æ¶ç»ˆäºå‘å¸ƒäº†ï¼ˆçŠ¹è®°å¾—ç¿˜é¦–ä»¥ç›¼çš„æˆ‘ï¼‰ï¼Œæ–°å»ºé¡¹ç›®ä¹Ÿå˜å¾—ååˆ†æ–¹ä¾¿ã€‚</p>
<p>åºŸè¯ï¼Œå°‘è¯´ã€‚è„šæ‰‹æ¶ï¼Œèµ°ä¸€æ³¢ã€‚ï¼ˆå•æŠ¼ X2ï¼‰</p>
<h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><ul>
<li><p>Visual Studio Codeï¼ˆèåœé’èœï¼Œå„æœ‰æ‰€çˆ±ï¼‰</p>
</li>
<li><p>Node.js v9.2.0ï¼ˆ&gt;= 8.9.0 å³å¯ï¼‰</p>
</li>
<li><p>@nestjs/cliï¼ˆå®˜æ–¹è„šæ‰‹æ¶ï¼‰</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> npm i -g @nestjs/cli</span><br></pre></td></tr></table></figure>
<p>Â· nest-demoï¼ˆé¡¹ç›®åˆå§‹åŒ–ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> nest new nest-demo</span><br></pre></td></tr></table></figure>
<h2 id="åˆè¯†-Nest"><a href="#åˆè¯†-Nest" class="headerlink" title="åˆè¯† Nest"></a>åˆè¯† Nest</h2><p>å¦‚æ— æ„å¤–ï¼Œé€šè¿‡è„šæ‰‹æ¶åˆå§‹åŒ–é¡¹ç›®çš„è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">âš¡ï¸  Creating your Nest project...</span><br><span class="line">ğŸ™Œ  We have to collect additional information:</span><br><span class="line"></span><br><span class="line">? description : description</span><br><span class="line">? version : 0.0.0</span><br><span class="line">? author : chenshihao</span><br><span class="line"></span><br><span class="line">ğŸ’¥  Thank you for your time!</span><br><span class="line"></span><br><span class="line">CREATE /nest-demo/.prettierrc (51 bytes)</span><br><span class="line">CREATE /nest-demo/README.md (339 bytes)</span><br><span class="line">CREATE /nest-demo/nodemon.json (147 bytes)</span><br><span class="line">CREATE /nest-demo/package.json (1527 bytes)</span><br><span class="line">CREATE /nest-demo/src/app.controller.spec.ts (588 bytes)</span><br><span class="line">CREATE /nest-demo/src/app.controller.ts (266 bytes)</span><br><span class="line">CREATE /nest-demo/src/app.module.ts (249 bytes)</span><br><span class="line">CREATE /nest-demo/src/app.service.ts (138 bytes)</span><br><span class="line">CREATE /nest-demo/src/main.hmr.ts (329 bytes)</span><br><span class="line">CREATE /nest-demo/src/main.ts (208 bytes)</span><br><span class="line">CREATE /nest-demo/test/app.e2e-spec.ts (593 bytes)</span><br><span class="line">CREATE /nest-demo/test/jest-e2e.json (154 bytes)</span><br><span class="line">CREATE /nest-demo/tsconfig.json (477 bytes)</span><br><span class="line">CREATE /nest-demo/tslint.json (895 bytes)</span><br><span class="line">CREATE /nest-demo/webpack.config.js (695 bytes)</span><br><span class="line">CREATE /nest-demo/.nestcli.json (60 bytes)</span><br><span class="line"></span><br><span class="line">? Which package manager would you â¤ï¸ to use? yarn</span><br><span class="line">â–¹â–¸â–¹â–¹â–¹ Take â˜•ï¸ or ğŸº during the packages installation process and enjoy your time</span><br><span class="line"></span><br><span class="line">ğŸš€  Successfully created project nest-demo</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šæ“ä½œåˆ›å»ºäº†ç§å­é¡¹ç›®å¹¶ç”¨ yarn å®‰è£…äº†ä¾èµ–åŒ…ã€‚å¦‚æœæ²¡æœ‰å®‰è£…æˆåŠŸçš„è¯ï¼Œå¯æ‰‹åŠ¨è¿›è¡Œå®‰è£…ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè„šæ‰‹æ¶å·¥å…·åˆ›å»ºäº†è‹¥å¹²æ–‡ä»¶ï¼ŒåŒ…æ‹¬</p>
<ul>
<li><p>æ ¹ç›®å½•</p>
<p>  å¤§å¤šä¸ºé…ç½®æ–‡ä»¶ï¼Œå¦‚ prettierã€nodemonã€tslint ç­‰å·¥å…·çš„é…ç½®æ–‡ä»¶ï¼ˆè‹¥ä¸ç†Ÿæ‚‰å¯ä»¥æš‚æ—¶å¿½ç•¥ï¼Œå°†é‡å¿ƒæ”¾åœ¨ *.ts æ–‡ä»¶ä¸Šæœ‰åŠ©äºå¿«é€Ÿå…¥æ‰‹æ¡†æ¶ï¼‰</p>
</li>
<li><p>test æ–‡ä»¶å¤¹</p>
<p>  ç«¯å¯¹ç«¯ï¼ˆe2eï¼‰æµ‹è¯•ç”¨ä¾‹ä¸é…ç½®æ–‡ä»¶</p>
</li>
<li><p>src æ–‡ä»¶å¤¹</p>
<p>  ä¸»ç¨‹åºå…¥å£æ–‡ä»¶åŠè‹¥å¹²æ¨¡å—æ–‡ä»¶ã€‚å…¶ä¸­æ–‡ä»¶å±‚æ¬¡å…³ç³»å¤§è‡´å¦‚ä¸‹</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2824648-bf041aad4ed10ed2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>æˆ‘ä»¬å¯¹æ–‡ä»¶ç»“æ„æœ‰äº†åˆæ­¥çš„è®¤è¯†</p>
<ul>
<li><p>å…¥å£æ–‡ä»¶ main.ts å¼•å¯¼ç¨‹åºè¿è¡Œï¼ŒåŠ è½½æ¨¡å— app.module.ts</p>
</li>
<li><p>æ¨¡å—ä¸­ï¼ŒåŒ…æ‹¬æ§åˆ¶å™¨ app.controller.tsï¼ŒæœåŠ¡æä¾›å•† app.service.tsï¼Œæµ‹è¯•ç”¨ä¾‹ app.controller.spec.ts ç­‰ç»„ä»¶ã€‚</p>
</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç›´æ¥ä»¥å¼€å‘æ¨¡å¼è¿è¡Œç¨‹åºã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> npm run start:dev</span><br></pre></td></tr></table></figure>
<p>å¦‚æ— æ„å¤–ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ§åˆ¶å°æœ‰ä»¥ä¸‹è¾“å‡ºæ—¥å¿—ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> nest-demo@0.0.0 start:dev /Users/victor/Desktop/nest-demo</span><br><span class="line"><span class="meta">&gt;</span> nodemon</span><br><span class="line"></span><br><span class="line">[nodemon] 1.18.3</span><br><span class="line">[nodemon] to restart at any time, enter `rs`</span><br><span class="line">[nodemon] watching: /Users/victor/Desktop/nest-demo/src/**/*</span><br><span class="line">[nodemon] starting `ts-node -r tsconfig-paths/register src/main.ts`</span><br><span class="line">[Nest] 16999   - 2018-8-20 11:33:49   [NestFactory] Starting Nest application...</span><br><span class="line">[Nest] 16999   - 2018-8-20 11:33:49   [InstanceLoader] AppModule dependencies initialized +8ms</span><br><span class="line">[Nest] 16999   - 2018-8-20 11:33:49   [RoutesResolver] AppController &#123;/&#125;: +14ms</span><br><span class="line">[Nest] 16999   - 2018-8-20 11:33:49   [RouterExplorer] Mapped &#123;/, GET&#125; route +3ms</span><br><span class="line">[Nest] 16999   - 2018-8-20 11:33:49   [NestApplication] Nest application successfully started +3ms</span><br></pre></td></tr></table></figure>
<p>ä»å›¾ä¸­æˆ‘ä»¬èƒ½å¤Ÿå¾—åˆ°çš„ä¿¡æ¯å¤§è‡´ä¸º</p>
<ul>
<li><p>è¿è¡Œ nodemon ç›‘å¬é¡¹ç›®æ–‡ä»¶</p>
</li>
<li><p>é€šè¿‡ ts-node å¼•å¯¼å…¥å£æ–‡ä»¶ main.ts</p>
</li>
<li><p>åˆå§‹åŒ–æ¨¡å—ä¸è·¯ç”±</p>
</li>
</ul>
<p>åœ¨ main.ts å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤ç«¯å£å·ä¸º 3000</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">main.ts</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">bootstrap</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> app = <span class="keyword">await</span> NestFactory.create(AppModule);</span><br><span class="line">  <span class="keyword">await</span> app.listen(<span class="number">3000</span>);</span><br><span class="line">&#125;</span><br><span class="line">bootstrap();</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç›´æ¥è®¿é—®åœ°å€ <code>http://localhost:3000</code> çœ‹çœ‹æ•ˆæœ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> curl localhost:3000</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>
<p>æ ·ä¾‹ä¸ä½œä¸ºå‚è€ƒï¼Œæ­£å¼å¼€å‘ä¸­ï¼Œæ¨èä½¿ç”¨ <a href="https://www.getpostman.com" target="_blank" rel="noopener">Postman</a> è¿›è¡Œ API è°ƒè¯•</p>
<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World!"></a>Hello World!</h2><p>çœ‹åˆ° â€œHello World! â€ çš„å­—ç¬¦ä¸²ï¼Œä¸ç¦è®©çŒ¿çƒ­è¡€æ¾æ¹ƒ â€”â€” ä»–åšåˆ°äº†ï¼</p>
<p>æˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹çœ‹è¿™ä¸ªå€¼æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p>
<p>é€šè¿‡ç»“æ„ç¤ºä¾‹å›¾ï¼Œæˆ‘ä»¬çŸ¥é“æ¨¡å— (module) æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œè€Œæ¯ä¸ªæ¨¡å—çš„æ§åˆ¶å™¨ (controller) æ›´æ˜¯æ‰®æ¼”ç€è¿ç­¹å¸·å¹„çš„è§’è‰²ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.controller.ts</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppController &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> readonly appService: AppService</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Get</span>()</span><br><span class="line">  root(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.appService.root();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>app.controller.ts æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªç±»ï¼Œé€šè¿‡è£…é¥°å™¨ @Controller() ä½¿å…¶æˆä¸ºä¸€ä¸ªè·¯ç”±æ§åˆ¶ç±»ã€‚ç±»æ–¹æ³•ä¸­ï¼Œæœ‰æ„é€ å‡½æ•° constructor ä»¥åŠå¸¦æœ‰è£…é¥°å™¨ @Get() çš„ root å‡½æ•°ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.service.ts</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppService &#123;</span><br><span class="line">  root(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello World!'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>root å‡½æ•°é€šè¿‡è°ƒç”¨ service ä¸­çš„ root æ–¹æ³•ï¼Œè¿”å›å­—ç¬¦ä¸² â€œHello World!â€ã€‚</p>
<p>æ­¤å¤–ï¼Œå…³äº HTTP å“åº”çš„æ“ä½œï¼ŒNest å¤§ä½“ä¸Šå·²ç»å¸®æˆ‘ä»¬å®‰æ’çš„æ˜æ˜ç™½ç™½äº†ï¼Œè¿™ä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„å†™æ³•ã€‚</p>
<ul>
<li><p>å½“æˆ‘ä»¬çš„å‡½æ•°è¿”å› JavaScript å¯¹è±¡æˆ–æ•°ç»„æ—¶ï¼Œè¿”å›å€¼ä¼šè¢«è‡ªåŠ¨è½¬åŒ–æˆ JSON å¯¹è±¡ï¼›</p>
</li>
<li><p>å½“æˆ‘ä»¬çš„å‡½æ•°è¿”å›å­—ç¬¦ä¸²æ—¶ï¼Œè¿”å›å€¼ä¸ä½œå¤„ç†ã€‚</p>
</li>
<li><p>å“åº”çŠ¶æ€ç é»˜è®¤æƒ…å†µä¸‹æ€»æ˜¯ 200ï¼Œé™¤äº† POST è¯·æ±‚ä¸º 201 å¤–ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬æ˜¯æœ‰åŠæ³•é€šè¿‡è£…é¥°å™¨è½»æ¾ä¿®æ”¹è¿”å›å€¼çš„ã€‚</p>
</li>
</ul>
<p>å½“ç„¶å•¦ï¼Œå¦‚æœæœ‰å€”å¼ºçš„è€å“¥éè¦æ“ä½œä¸€ä¸‹ response å¯¹è±¡ï¼Œä¹Ÿä¸æ˜¯ä¸å¯ä»¥æ»´ã€‚</p>
<p>è¯»åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¾¿å¤§è‡´äº†è§£èƒ½ç”¨ GET æ–¹æ³•è®¿é—® <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> å¾—åˆ°â€œHello World!â€çš„æ¥é¾™å»è„‰äº†å§ã€‚</p>
<h2 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h2><p>åœ¨ä¸Šè¿°ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°è®¸å¤šè£…é¥°å™¨ï¼Œå¦‚ @Controller()ã€@Injectable() ç­‰ã€‚</p>
<p>è£…é¥°å™¨æ˜¯ä»€ä¹ˆï¼Ÿè£…é¥°å™¨çš„å®šä¹‰å¤§è‡´å¦‚ä¸‹</p>
<blockquote>
<p>An ES2016 decorator is an expression which returns a function and can take a target, name and property descriptor as arguments. You apply it by prefixing the decorator with an @ character and placing this at the very top of what you are trying to decorate. Decorators can be defined for either a class or a property.<br>ES7 è£…é¥°å™¨æ˜¯ä¸€ç§è¿”å›å‡½æ•°ï¼Œä¸”å¯ä¼ é€’ç›®æ ‡å¯¹è±¡ã€åç§°ä¸å±æ€§æè¿°ä½œä¸ºå‚æ•°çš„è¡¨è¾¾å¼ã€‚ä½ å¯ä»¥ä½¿ç”¨@å­—ç¬¦ä½œä¸ºå‰ç¼€å¹¶å°†è£…é¥°å™¨æ”¾åœ¨ä½ æƒ³è£…é¥°çš„å¯¹è±¡ä¸Šã€‚è£…é¥°å™¨å¯ä»¥è¢«ç”¨åœ¨ä¸€ä¸ªç±»æˆ–è€…ä¸€ä¸ªå±æ€§ä¸Šã€‚</p>
</blockquote>
<p>æƒ³è¦äº†è§£æ›´å¤šå…³äºè£…é¥°å™¨çš„çŸ¥è¯†ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« æˆ–è€…è‡ªè¡Œæœç´¢<br><a href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841" target="_blank" rel="noopener">https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841</a></p>
<p>è£…é¥°å™¨ (Decorator) ä½œä¸º ES7 çš„ä¸€å¤§ç‰¹æ€§ï¼Œåœ¨ TypeScript ä¸­å¯ä»¥è¢«è‡ªç”±è¿ç”¨ï¼Œåœ¨ Nest ä¸­æ›´æ˜¯å¾—åˆ°äº†åˆç†çš„å¼€å‘ä¸åˆ©ç”¨ã€‚</p>
<p>çºµè§‚ Nest ï¼Œè£…é¥°å™¨è´¯ç©¿äº†æ•´ä¸ª Nest æ¡†æ¶ï¼Œå¦‚ï¼š</p>
<ul>
<li><p>æ¨¡å—ï¼Œä¸€ä¸ªå¸¦æœ‰ @Module() è£…é¥°å™¨çš„ç±»</p>
</li>
<li><p>æ§åˆ¶å™¨ï¼Œä¸€ä¸ªå¸¦æœ‰ @Controller() è£…é¥°å™¨çš„ç±»</p>
</li>
<li><p>æä¾›å•†ï¼Œä¸€ä¸ªå¸¦æœ‰ @Injectable() è£…é¥°å™¨çš„ç±»</p>
</li>
<li><p>é€šè¿‡è£…é¥°å™¨è¯­æ³•è£…é¥°å‚æ•°ï¼Œæ›´æ¸…æ™°ä¾¿æ·åœ°å–å€¼</p>
</li>
</ul>
<p>ä¸ºäº†æ›´å¥½åœ°è¯´æ˜è£…é¥°å‚æ•°ï¼Œæˆ‘ä»¬ä¸¾ä¸ªæ —å­ï¼Œä¿®æ”¹ä¸€ä¸‹ app.controller.ts å’Œ app.service.ts</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.controller.ts</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Query &#125; <span class="keyword">from</span> <span class="string">'@nestjs/common'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Get</span>()</span><br><span class="line">root(<span class="meta">@Query</span>(<span class="string">'name'</span>) name: <span class="built_in">string</span> = <span class="string">'Victor'</span>): <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.appService.root(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾€ app.controller.ts çš„ GET æ–¹æ³•ä¸­æ·»åŠ å‚æ•° nameï¼Œå…¶ä¸­ Query æŒ‡çš„æ˜¯ url ä¸­çš„ params å‚æ•°</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.service.ts</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppService &#123;</span><br><span class="line">  root(name: <span class="built_in">string</span> = <span class="string">'World'</span>): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`Hello <span class="subst">$&#123;name&#125;</span>!`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é…åˆæ§åˆ¶å±‚ï¼Œå¾€ app.service.ts æ·»åŠ å‚æ•° name ä»¥è¯´æ˜å€¼çš„æ”¹å˜ã€‚</p>
<p>æ­¤æ—¶æœåŠ¡ä¼šè‡ªåŠ¨é‡å¯ï¼Œæˆ‘ä»¬ä»¥ GET æ–¹å¼è¯·æ±‚æ–°åœ°å€ </p>
<p><a href="http://localhost:3000?name=victor" target="_blank" rel="noopener">http://localhost:3000?name=victor</a> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> curl http://localhost:3000?name=Victor</span><br><span class="line">Hello Victor!</span><br></pre></td></tr></table></figure>
<p>Surpriseï¼å¥½äº†ï¼Œä¸€ä¸ª url ä¼ å‚çš„é²œæ´»æ —å­å°±è¿™ä¹ˆè½»æ¾åŠ æ„‰å¿«çš„ä¸¾å®Œäº†ã€‚</p>
<p>é™¤äº† @Query() ä¹‹å¤–ï¼ŒNest å†…ç½®çš„è¿˜æœ‰ä¸€äº›è£…é¥°å™¨æä¾›ç»™æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ï¼Œåˆ—ä¸¾ä¸€ä¸‹</p>
<ul>
<li><p>@Request() â€”â€” Express è¯·æ±‚å¯¹è±¡</p>
</li>
<li><p>@Response() â€”â€” Express å“åº”å¯¹è±¡</p>
</li>
<li><p>@Session() â€”â€” Session å¯¹è±¡</p>
</li>
<li><p>@Param(param?: string) â€”â€” RESTful é£æ ¼çš„è·¯ç”±å‚æ•°</p>
</li>
<li><p>@Body(param?: string) â€”â€” è¯·æ±‚ä½“</p>
</li>
<li><p>@Headers(param?: string) â€”â€” è¯·æ±‚å¤´</p>
</li>
</ul>
<p>å®˜æ–¹æä¾›çš„è£…é¥°å™¨å›ºç„¶æ–¹ä¾¿ï¼Œç„¶é¹…åœ¨é”™ç»¼å¤æ‚çš„éœ€æ±‚ä¸‹ï¼Œä»…ä»…æœ‰è¿™å‡ ä¸ªè£…é¥°å™¨è¿˜æ˜¯ç•¥æ˜¾ä¸è¶³çš„ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥è‡ªå®šä¹‰è£…é¥°å™¨ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶ name.decorator.tsï¼Œä¸ºäº†é¿å…é€»è¾‘å¹²æ‰°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ç›´æ¥è¿”å›ä¼ é€’çš„å€¼ dataã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">name.decorator.ts</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createParamDecorator &#125; <span class="keyword">from</span> <span class="string">'@nestjs/common'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Name = createParamDecorator(<span class="function">(<span class="params">data, req</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>åœ¨ controller ä¸­å¼•ç”¨è‡ªå®šä¹‰è£…é¥°å™¨ï¼Œå¹¶ä¼ å…¥å¸¸é‡ Victorã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.controller.ts</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Name &#125; <span class="keyword">from</span> <span class="string">'name.decorator'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Get</span>()</span><br><span class="line">root(<span class="meta">@Name</span>(<span class="string">'Victor'</span>) name: <span class="built_in">string</span>): <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.appService.root(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶æœåŠ¡é‡å¯ï¼Œå†æ¬¡è®¿é—® <code>http://localhost:3000</code>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> curl localhost:3000</span><br><span class="line">Hello Victor!</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è£…é¥°å™¨çš„ä½œç”¨ï¼Œæˆ‘ä»¬æˆåŠŸçš„å°† name çš„å€¼è®¾ç½®æˆ Victorï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­å¯ä»¥æ·»åŠ æ›´ä¸ºå¤æ‚çš„é€»è¾‘ã€‚</p>
<h2 id="ä¾èµ–æ³¨å…¥"><a href="#ä¾èµ–æ³¨å…¥" class="headerlink" title="ä¾èµ–æ³¨å…¥"></a>ä¾èµ–æ³¨å…¥</h2><p>å¦‚æœè¯´è£…é¥°å™¨è¯­æ³•æ˜¯ Nest å¥ç¾çš„èº«æï¼Œé‚£ä¹ˆä¾èµ–æ³¨å…¥åˆ™å¯ä»¥ç§°ä¸º Nest æœ‰è¶£çš„çµé­‚äº†ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œä¾èµ–æ³¨å…¥ï¼ˆDI, Dependency Injectionï¼‰æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ—¨åœ¨æä¾›å¯¹è±¡å®ä¾‹ï¼Œè°ƒç”¨å•å…ƒåœ¨ä½¿ç”¨ä¾èµ–å¯¹è±¡å®ä¾‹æ—¶æ— éœ€å…³å¿ƒå…¶æä¾›æ–¹å¼ï¼Œè€Œæ˜¯ç»Ÿä¸€ç”± DI ç³»ç»Ÿæä¾›ã€‚</p>
<p>æƒ³è¦äº†è§£æ›´å¤šä¾èµ–æ³¨å…¥çŸ¥è¯†ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹æ–‡ç« æˆ–è€…è‡ªè¡Œæœç´¢</p>
<p><a href="https://angular.io/guide/dependency-injection-pattern" target="_blank" rel="noopener">https://angular.io/guide/dependency-injection-pattern</a></p>
<p>äº‹å®ä¸Šï¼ŒNest çš„è®¾è®¡ç†å¿µæ˜¯ï¼Œâ€œä¸‡ç‰©çš†å¯ä¸ºæä¾›å•†â€ â€”â€” å¦‚æœåŠ¡ç±»ï¼ˆserviceï¼‰ã€ä»“åº“ç±»ï¼ˆrepositoryï¼‰ã€å·¥å‚ç±»ï¼ˆfactoryï¼‰ã€å¸®åŠ©ç±»ï¼ˆhelperï¼‰ç­‰ç­‰ã€‚</p>
<p>æˆ‘ä»¬ä»å®é™…ä»£ç å…¥æ‰‹äº†è§£è¿™ä¸€æ¦‚å¿µï¼Œå‰é¢æåˆ°çš„ @Injectable() è£…é¥°å™¨ï¼Œå…¶è£…é¥°çš„å¯¹è±¡æ­£æ˜¯æˆ‘ä»¬æ‰€è¯´çš„â€œä¾èµ–å¯¹è±¡â€ï¼Œä¹Ÿå°±æ˜¯ä¾‹å­ä¸­çš„ service ç±»ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.module.ts</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  imports: [],</span><br><span class="line">  controllers: [AppController],</span><br><span class="line">  providers: [AppService],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ module æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å£°æ˜äº† AppService ç±»ä½œä¸º providerï¼Œè¿™æ˜¯ AppController å¯ä»¥æ— å®ä¾‹åŒ–ç›´æ¥ä½¿ç”¨ appService å¯¹è±¡çš„ä¼ç¬”ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.controller.ts</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppController &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> readonly appService: AppService</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Get</span>()</span><br><span class="line">  root(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.appService.root();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>AppService ä½œä¸ºå¯æ³¨å…¥çš„ä¾èµ–å¯¹è±¡ï¼Œé€šè¿‡åœ¨æ„é€ å‡½æ•° constructor ä¸­å£°æ˜çš„æ–¹å¼ï¼Œé…åˆ DI æ¨¡å¼ï¼Œè§£å†³äº†ä¸¤è€…ä¹‹é—´çš„ä¾èµ–å…³ç³»ä¸ç‹¬ç«‹æ€§ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ–¹æ³•ä¸­è°ƒç”¨ appServiceã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.service.ts</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppService &#123;</span><br><span class="line">  root(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello World!'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç†è§£äº†ä¾èµ–æ³¨å…¥çš„æ¦‚å¿µï¼Œå¯ä»¥æ›´å¥½çš„é˜…è¯»ä¸å­¦ä¹  Nest çš„å…¶ä»–å†…å®¹ï¼Œå¦‚ä¸­é—´ä»¶ï¼ˆMiddlewireï¼‰ã€ç®¡é“ï¼ˆPipeï¼‰ã€é˜²å¾¡å±‚ï¼ˆGuardï¼‰ã€æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ç­‰ç­‰ï¼Œéƒ½æ˜¯é€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼ä¸æˆ‘ä»¬çš„æ§åˆ¶å±‚è¿›è¡Œå…³è”çš„ã€‚</p>
<p>å®é™…ä¸Šï¼Œé…åˆ @Inject() è£…é¥°å™¨ï¼Œå¯ä»¥å®ç°æ›´ä¸ºå¤šæ ·çš„æ³¨å…¥ç±»å‹ï¼Œè¿™æ˜¯æ›´ä¸ºé«˜çº§çš„ provider æ³¨å…¥æ–¹å¼ï¼Œç”±äºæ–‡ç« ç¯‡å¹…åŸå› ï¼Œåœ¨æ­¤å°±ä¸èµ˜è¿°äº†ã€‚</p>
<h2 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h2><p>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡å…¬ä¼—å·æ–‡ç« ã€‚</p>
<p>åˆå¿ƒæ˜¯ä¸ºäº†ä»‹ç» Nest æ¡†æ¶ï¼Œå¸Œæœ›æ˜¯ä¸ä»…æœ‰è½åˆ°å®å¤„çš„ä»£ç ç¤ºä¾‹ï¼Œä¸è‡³äºæ˜¾å¾—å¤ªç©ºè™šï¼›åŒæ—¶ä¹Ÿæœ‰æ›´ä¸ºé‡è¦çš„æ ¸å¿ƒæ¦‚å¿µä»‹ç»ï¼Œè®©è¯»è€…æœ‰æ›´å¥½çš„å¤§å±€è§‚ä¸å­¦ä¹ æ–¹å‘ã€‚</p>
<p>ä¸€ç¯‡æ–‡ç« å¾€å¾€ä¸è¶³ä»¥æè¿°äº‹ç‰©çš„å…¨éƒ¨ï¼Œè¿˜æœ‰å¾ˆå¤šä¼˜ç§€çš„æ€æƒ³ä¸å·§å¦™çš„è®¾è®¡ç­‰ç€æˆ‘ä»¬å»æ¢ç´¢ï¼Œæˆ‘ä»¬ä¸‹ç¯‡æ–‡ç« è§ï¼</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://docs.nestjs.com" target="_blank" rel="noopener">https://docs.nestjs.com</a></li>
</ul>
<h2 id="åŸåˆ›ä½œè€…"><a href="#åŸåˆ›ä½œè€…" class="headerlink" title="åŸåˆ›ä½œè€…"></a>åŸåˆ›ä½œè€…</h2><p>é™ˆä»•è±ªï¼Œå¹´åå…«ï¼Œéªšè¯è¿ç¯‡ç¬‘å“ˆå“ˆã€‚skr~</p>
<h2 id="åŸåˆ›é“¾æ¥"><a href="#åŸåˆ›é“¾æ¥" class="headerlink" title="åŸåˆ›é“¾æ¥"></a>åŸåˆ›é“¾æ¥</h2><p><a href="https://mp.weixin.qq.com/s/LKCecn2z1Pln90atQ0kcWw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/LKCecn2z1Pln90atQ0kcWw</a></p>


                <hr>
                
                <ul class="pager">
                    
                    
                        <li class="next">
                            <a href="/2017/12/31/summary-2017/" data-toggle="tooltip" data-placement="top" title="ç»´ç‰¹é™ˆå…ˆæ£®çš„ 2017">ä¸‹ä¸€ç¯‡ &rarr;</a>
                        </li>
                    
                </ul>

                <!-- å¦‚æœå¼€å¯è¯„è®ºåŠŸèƒ½ -->
                

                    
                        <!-- disqus è¯„è®ºæ¡† start -->
                        <div class="comment">
                            <div id="disqus_thread" class="disqus-thread"></div>
                        </div>
                        <!-- disqus è¯„è®ºæ¡† end -->
                
                        <!-- disqus å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
                        <script type="text/javascript">
                            /* * * CONFIGURATION VARIABLES * * */
                            var disqus_shortname = "chenshihao";
                            var disqus_identifier = "http://chenshihao.site/2018/08/22/nest/";
                            var disqus_url = "http://chenshihao.site/2018/08/22/nest/";

                            (function() {
                                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                            })();
                        </script>
                        <!-- disqus å…¬å…±JSä»£ç  end -->
                    

                

            </div>
    <!-- Side Catalog Container -->
        

    <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                

                <!-- Friends Blog -->
                
            </div>

        </div>
    </div>
</article>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/wei-te-chen-xian-sen-5">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">çŸ¥</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/carefreesigh">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/ChenShihao">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank"  href="https://www.linkedin.com/in/chenshihao">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; ç»´ç‰¹é™ˆå…ˆæ£® 2018 
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("https://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="https://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://chenshihao.site/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-90745665-1';
    var _gaDomain = 'auto';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = '1d037a55bb5703fefc271401970638d4';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>


<!-- Side Catalog -->




<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
